
<h3>Admin Dashboard - Wahlergebnisse</h3>
<div id="stats" style="margin-bottom: 20px; font-weight: bold;"></div>
<div id="voteLog" style="border: 1px solid #ccc; height: 200px; overflow-y: scroll; padding: 10px; background: #f9f9f9;">
    Warte auf Stimmen...
</div>

<hr>
<button id="resetBtn" style="background: red; color: white; padding: 10px; margin-top: 20px; cursor: pointer;">
    ⚠️ ALLES ZURÜCKSETZEN (System & Browser)
</button>

<script>
// 1. Function to get votes from Server
function updateResults() {
    fetch("http://localhost:2000/results")
        .then(res => res.json())
        .then(votes => {
            const log = document.getElementById("voteLog");
            const stats = document.getElementById("stats");
            
            // Show count
            stats.textContent = `Gesamte Stimmen: ${votes.length}`;

            // List votes
            if(votes.length === 0) {
                log.innerHTML = "Keine Stimmen vorhanden.";
            } else {
                log.innerHTML = votes.map(v => 
                    `<div>[${new Date(v.timestamp).toLocaleTimeString()}] <b>${v.teacher}</b>: ${v.rating}</div>`
                ).join("");
            }
        });
}

// Update every 3 seconds
setInterval(updateResults, 3000);
updateResults();

// 2. Reset Logic
document.getElementById("resetBtn").addEventListener("click", function() {
    if (confirm("Wirklich alle Daten löschen?")) {
        fetch("http://localhost:2000/reset", { method: "POST" })
            .then(res => res.json())
            .then(data => {
                alert("Server wurde zurückgesetzt!");
                updateResults();
            });
    }
});
</script>
